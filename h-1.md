# H-1 Viisikko  

Kone millä tein harjoituksen:  

AMD Ryzen 2600X Six-Core Processor 3.6 ghz   

16GB RAM  

Windows 10 Pro 64-bit käyttöjärjestelmä  

Oracle VM VirtualBox Manager

## 

Tehtävä löytyy sivulta: https://terokarvinen.com/2023/configuration-management-2023-autumn/  


## x) Lue ja tiivistä  

Karvinen 2023: https://terokarvinen.com/2023/create-a-web-page-using-github/  

- sivustolla kerrotaan miten rekisteröidään Githubiin
- uuden repositorion luominen
- uuden .md tiedoston lisääminen weppisivuksi
- miten kirjoitetaan markdownia ja commitataan githubiin
- miten sivun julkaistaan githubissa

##

Karvinen 2023: https://terokarvinen.com/2021/salt-run-command-locally/  

- artikkelissa kerrotaan miten Salt ohjelmaa käytetään ison määrän "orja"koneiden hallinnointiin verkossa  
- Saltin asennus Debianiin tai Ubuntuun: $ sudo apt-get -y install salt-minion  
- pkg.installed: $ sudo salt-call --local -l info state.single pkg.installed tree  
- file.managed (linuxissa kaikki settingsit on teksitiedostona): $ sudo salt-call --local -l info state.single file.managed /tmp/moikayttaja   
- service.running käytetään automaattiisesti uudelleen käynnistämään demonin kun asetuksia muutetaan:  
  $ sudo salt-call --local -l info state.single service.running apache2 enable=True  
  $ sudo salt-call --local -l info state.single service.dead apache2 enable=False  
- user.present - User should Exist  
  $ sudo salt-call --local -l info state.single user.present kayttaja  
  $ sudo salt-call --local -l info state.single user.absent kayttaja  
- cmd.run - Running a command  
  $ sudo salt-call --local -l info state.single cmd.run 'touch /tmp/foo' creates="/tmp/foo"  
- ohejita saa:  
  $ sudo salt-call --local sys.state_doc  

##

## a) Asenna Salt koneellesi  

https://terokarvinen.com/2023/configuration-management-2023-autumn/  

Sivuston vinkeissä on annettu komennot Saltin asennukseen Debian 12 järjestelmälle.

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/19352b50-3719-40fa-bd9d-9266bf4c4147)  

Ajoin terminaalissa komennot kuten yllä olevassa kuvat. Ensimmäisen komennon kansion luomisen osalta tuli ilmoitus, että kansio on jo olemassa.  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/9350e339-60b6-4e91-926c-928dfcb1d446)  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/12eaec28-bb73-42dd-bd07-43c674b5b33d)  

Tarkistin että Salt löytyy nyt komennolla: $ sudo salt-call --version  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/437a2df4-30fa-418c-b1bd-7ed6adfcc523)

##

## c) Viisi tärkeintä  

Tehtävässä pyydetään näyttämään esimerkit viidestä tärkeimmästä Saltin tilafunktiosta, pkg, file, service, user, cmd  

Käyn läpi komennot mitkä on https://terokarvinen.com/2021/salt-run-command-locally/ sivulle:  

- pkg.installed - tapa millä applikaatio voidaan asentaa:

Testataan antamalla komennot: 

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/f91d2275-1cfa-46c6-8421-976f097d3048)  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/b14855b0-6fe5-46db-b538-6ec52ee8961f)  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/1e2e2072-7dc2-4a8e-afdf-5165df7f675e)


Tämä tosiaan asentaa pkg tiedostot mitä käytetään tiedostoina applikaatioiden asentamiseen. Tässä ne myös poistetaan mikä näkyy yllä olevien kuvien statuksista.  

- file.managed - there should be a file:

$ sudo salt-call --local -l info state.single file.managed /tmp/hello  

Antaa vastaukseksi:  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/18c62177-d84d-42e1-826d-fc4dbd584097)  

Muokataan sisältöä lisäämällä "foo": 

sudo salt-call --local -l info state.single file.managed /tmp/hello contents="foo"  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/239b62f4-9f18-4329-9249-4ef75725a00c)  

Tiedosto on siis päivittynyt.  

##

service.running - A Daemon is running  

Tätä ilmeisesti yleensä käytetään jonku demonin uudelleen käynnistämiseen jos asetuksia on muokattu. Tässä tapauksessa käynnistetään Apache2  
uudestaan.  

$ sudo salt-call --local -l info state.single service.running apache2 enable=True  

Vastaukseksi tulee, että palvelin on jo päällä:  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/632f79a1-5417-467c-91b7-3a0b31e1371f)  

Laitetaan se nyt pois päältä komennolla: $ sudo salt-call --local -l info state.single service.dead apache2 enable=False  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/82b0345a-d541-4564-9a4c-17c5adee7549)  

Sieltä tulee bvastaukseksi "apache 2 has been disabled, and is dead" eli palvelin on pois päältä.

##  

user present:  

Tällä ilmeisesti voidaan kytkeä päälle/poistaa joku käyttäjä.

$ sudo salt-call --local -l info state.single user.present user1  

$ sudo salt-call --local -l info state.single user.absent user1  

Kokeilen näitä komentoja ja vastaukseksi tulee:  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/ea5f583b-41ec-4c8a-8375-7881fbcdb530)  

Uusi käyttäjä on siis luuotu.  

Toisella komennolla taas saadaan käyttäjä poistettua vastauksen perusteella:  

![image](https://github.com/aarott/palvelinten_hallinta/assets/78908566/72aa4fec-3db2-4f61-98f6-311730476df7)


















